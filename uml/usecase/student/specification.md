# 学员用例规约


## 1. 基础系统操作

### 1.1 注册系统（UC00）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC00 |
| 用例名称 | 注册系统 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员未注册过系统账号<br>2. 提供有效的手机号（未被占用） |
| 后置条件 | 1. 系统在`student`表新增学员记录<br>2. 自动创建学员账户（`student_account`表新增记录，初始余额为0）<br>3. 返回注册成功提示，引导至登录页 |
| 基本流程 | 1. 学员访问系统注册页面，输入手机号、设置密码（≥8位，含数字+字母）、获取并填写验证码<br>2. 点击“注册”，系统调用`UserService.register()`方法校验信息<br>3. 校验通过后，保存学员基础信息，关联默认校区（或提示后续选择校区）<br>4. 注册成功，跳转至登录页 |
| 扩展流程 | 1. 手机号已被注册：系统提示“该手机号已注册，请直接登录”<br>2. 验证码错误/过期：系统提示“验证码错误或已过期，请重新获取”<br>3. 密码格式不满足要求：系统提示“密码需至少8位，且包含数字和字母” |


### 1.2 登录系统（UC01）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC01 |
| 用例名称 | 登录系统 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已完成系统注册<br>2. 输入正确的账号（手机号）和密码 |
| 后置条件 | 1. 系统生成登录令牌（Token），关联学员ID<br>2. 跳转至学员个人首页，加载个人基础信息（姓名、剩余课时等） |
| 基本流程 | 1. 学员在登录页输入手机号和密码，点击“登录”<br>2. 系统调用`AuthService.login()`校验账号密码<br>3. 校验通过后，`TokenService`生成学员角色令牌并返回<br>4. 前端存储令牌，跳转至学员首页 |
| 扩展流程 | 1. 账号不存在：系统提示“该账号未注册，请先注册”<br>2. 密码错误：系统提示“密码错误，请重新输入”（连续3次错误锁定10分钟）<br>3. 账号被禁用：系统提示“账号已被禁用，请联系管理员” |


### 1.3 登出系统（UC02）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC02 |
| 用例名称 | 登出系统 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统 |
| 后置条件 | 1. 登录令牌失效，无法访问学员专属功能<br>2. 清除前端缓存的个人信息，跳转至登录页 |
| 基本流程 | 1. 学员点击个人首页右上角“登出”按钮<br>2. 系统调用`AuthService.logout()`销毁当前令牌<br>3. 页面自动跳转至登录页，提示“已安全登出” |
| 扩展流程 | - |


## 2. 个人信息维护（UC1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC1 |
| 用例名称 | 维护个人信息 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统 |
| 后置条件 | 学员信息更新至`student`表（可修改字段：姓名、性别、联系电话、紧急联系人、所属校区等） |
| 基本流程 | 1. 学员进入“个人中心-个人信息”页面<br>2. 点击“编辑”按钮，修改目标字段（姓名、紧急联系人等）<br>3. 若修改手机号，需通过原手机号获取验证码校验身份<br>4. 点击“保存”，系统调用`StudentService.updateInfo()`校验并保存数据<br>5. 保存成功，页面刷新显示更新后信息 |
| 扩展流程 | 1. 修改手机号已被占用：系统提示“该手机号已被使用，请更换其他手机号”<br>2. 身份校验失败（验证码错误）：系统提示“验证码错误，身份校验失败”<br>3. 必填字段为空（如紧急联系人）：系统提示“紧急联系人不能为空” |


## 3. 教练广场模块

### 3.1 选择教练
#### 3.1.1 查询教练（UC2_1_1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC2_1_1 |
| 用例名称 | 查询教练 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统，且已选择所属校区 |
| 后置条件 | 系统返回所属校区的教练列表（支持筛选、分页） |
| 基本流程 | 1. 学员进入“教练广场”页面<br>2. 系统默认展示所属校区的所有已认证教练（调用`CoachService.getCoachesBySchoolId()`）<br>3. 学员可通过筛选条件（教练等级、专长、评分）缩小范围，点击“查询”<br>4. 系统根据筛选条件更新列表，支持按“评分”“预约量”排序 |
| 扩展流程 | 1. 未选择所属校区：系统提示“请先在个人信息中选择所属校区”<br>2. 无符合条件的教练：系统提示“未找到符合条件的教练” |


#### 3.1.2 查看教练详情（UC2_1_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC2_1_2 |
| 用例名称 | 查看教练详情 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统，且已进入教练列表页面 |
| 后置条件 | 系统展示目标教练的详细信息（基础信息、专长、授课风格、学员评价、可预约时间段等） |
| 基本流程 | 1. 学员在教练列表中点击目标教练的“查看详情”按钮<br>2. 系统调用`CoachService.getCoachDetail()`获取教练详情（含关联的学员评价、近期课表）<br>3. 页面展示教练头像、姓名、等级、专长、授课年限、学员评分，及近7天可预约时间段 |
| 扩展流程 | - |


#### 3.1.3 选择教练（UC2_1_3）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC2_1_3 |
| 用例名称 | 选择教练 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 未绑定专属教练（或已解绑原教练）<br>3. 目标教练为所属校区已认证教练 |
| 后置条件 | 1. 系统在`student_coach`表新增关联记录（学员ID-教练ID）<br>2. 发送通知给目标教练（“有新学员选择您作为专属教练”） |
| 基本流程 | 1. 学员在教练详情页点击“选择为我的教练”按钮<br>2. 系统弹出确认弹窗（“确认选择XX教练作为您的专属教练？”）<br>3. 学员点击“确认”，系统调用`StudentCoachService.bindCoach()`创建关联<br>4. 绑定成功，页面提示“已成功选择XX教练”，并跳转至“我的教练”页面 |
| 扩展流程 | 1. 已绑定教练：系统提示“您已绑定专属教练，如需更换请先发起更换申请”<br>2. 教练暂不可用（如休假）：系统提示“该教练当前暂不可用，请选择其他教练” |


### 3.2 我的教练（UC2_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC2_2 |
| 用例名称 | 我的教练 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 已绑定专属教练 |
| 后置条件 | 系统展示已绑定教练的详情及关联服务（预约课程、发送消息、更换教练入口） |
| 基本流程 | 1. 学员进入“教练广场-我的教练”页面<br>2. 系统调用`StudentCoachService.getMyCoach()`获取已绑定教练信息<br>3. 页面展示教练详情、近期可预约课程、我的历史课程记录<br>4. 提供“预约课程”“发起更换”“发送消息”按钮，支持快速操作 |
| 扩展流程 | 1. 未绑定教练：系统提示“您尚未绑定专属教练，请前往教练广场选择” |


### 3.3 更换教练（UC2_3）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC2_3 |
| 用例名称 | 更换教练 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 已绑定专属教练 |
| 后置条件 | 1. 系统在`coach_change_application`表新增更换申请（状态为“待审批”）<br>2. 发送通知给原教练及校区管理员（“学员XX发起教练更换申请”） |
| 基本流程 | 1. 学员在“我的教练”页面点击“更换教练”按钮<br>2. 选择新教练（流程同“查询教练-选择教练”），填写更换原因（必填）<br>3. 点击“提交申请”，系统调用`CoachChangeService.createApplication()`生成申请<br>4. 提交成功，页面提示“更换申请已提交，待管理员审批”，并展示申请进度 |
| 扩展流程 | 1. 存在未审批的更换申请：系统提示“您有未审批的更换申请，请勿重复提交”<br>2. 未填写更换原因：系统提示“请填写更换教练的原因” |


## 4. 账户充值模块

### 4.1 查看余额（UC3_1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC3_1 |
| 用例名称 | 查看余额 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统 |
| 后置条件 | 系统展示学员账户当前余额、剩余课时（余额换算） |
| 基本流程 | 1. 学员进入“账户中心-账户余额”页面<br>2. 系统调用`AccountService.getBalance()`查询`student_account`表数据<br>3. 页面展示“当前余额（元）”“剩余课时（按1课时=XX元换算）”，及最近1条充值记录 |
| 扩展流程 | - |


### 4.2 充值（UC3_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC3_2 |
| 用例名称 | 充值 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 绑定有效的支付方式（微信/支付宝） |
| 后置条件 | 1. 支付成功后，学员账户余额（`student_account.balance`）增加<br>2. 系统在`recharge_record`表新增充值记录（含支付方式、金额、时间、订单号） |
| 基本流程 | 1. 学员进入“账户中心-充值”页面<br>2. 选择充值金额（固定档位：100元、200元、500元、自定义）<br>3. 选择支付方式（微信/支付宝），点击“确认充值”<br>4. 系统调用`RechargeService.createRechargeOrder()`生成充值订单，跳转至对应支付页面<br>5. 学员完成支付，支付平台回调系统确认支付状态<br>6. 系统更新账户余额及充值记录，页面提示“充值成功” |
| 扩展流程 | 1. 支付超时：系统提示“支付超时，请重新发起充值”<br>2. 支付失败（如余额不足）：系统提示“支付失败，请检查支付方式后重试”<br>3. 自定义金额≤0：系统提示“充值金额必须大于0” |


### 4.3 查看交易记录（UC3_3）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC3_3 |
| 用例名称 | 查看交易记录 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统 |
| 后置条件 | 系统展示学员账户的所有充值记录（分页、支持时间筛选） |
| 基本流程 | 1. 学员进入“账户中心-交易记录”页面<br>2. 系统默认展示近30天的充值记录（调用`RechargeService.getRechargeRecords()`）<br>3. 学员可选择时间范围（如近7天、近90天、自定义），点击“筛选”<br>4. 系统根据时间范围更新记录列表，展示每条记录的“订单号、金额、支付方式、时间、状态” |
| 扩展流程 | 1. 无交易记录：系统提示“暂无充值记录” |


## 5. 课程预约模块

### 5.1 查看课表（UC4_1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC4_1 |
| 用例名称 | 查看课表 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 已选择所属校区 |
| 后置条件 | 系统展示所属校区的课程表（按周/日视图，标注可预约/已满状态） |
| 基本流程 | 1. 学员进入“课程预约-校区课表”页面<br>2. 系统调用`ScheduleService.getSchoolSchedule()`获取所属校区课表<br>3. 页面提供“周视图”“日视图”切换，课表条目标注“课程名称、教练、时间、场地、剩余名额”<br>4. 已预约的课程标注“已预约”，已满名额的课程标注“已满” |
| 扩展流程 | 1. 未选择所属校区：系统提示“请先在个人信息中选择所属校区”<br>2. 校区未创建课表：系统提示“所属校区暂未发布课表，请稍后查看” |


### 5.2 进行预约（UC4_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC4_2 |
| 用例名称 | 进行预约 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 目标课程有剩余名额<br>3. 学员账户余额≥1课时费用 |
| 后置条件 | 1. 系统在`reservation`表新增预约记录（学员ID-课程ID，状态为“已预约”）<br>2. 目标课程剩余名额减1<br>3. 发送上课提醒（预约成功时及上课前1小时） |
| 基本流程 | 1. 学员在课表中点击目标课程的“预约”按钮<br>2. 系统弹出确认弹窗（展示课程信息、扣除课时/金额）<br>3. 学员点击“确认预约”，系统调用`ReservationService.createReservation()`校验余额及名额<br>4. 校验通过，创建预约记录，更新课程剩余名额<br>5. 页面提示“预约成功”，并在“我的预约”中展示 |
| 扩展流程 | 1. 余额不足：系统提示“账户余额不足，无法预约，请先充值”<br>2. 课程已满：系统提示“该课程已约满，无法预约”<br>3. 同一时间段重复预约：系统提示“您已预约同一时间段的课程，请勿重复预约” |


### 5.3 取消预约（UC4_3）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC4_3 |
| 用例名称 | 取消预约 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在“已预约”状态的课程，且距离上课时间≥2小时 |
| 后置条件 | 1. 预约记录状态更新为“已取消”<br>2. 课程剩余名额加1<br>3. 已扣除的课时/金额退还至学员账户（若未扣费则无此步骤） |
| 基本流程 | 1. 学员进入“课程预约-我的预约”页面<br>2. 找到目标预约课程，点击“取消预约”按钮<br>3. 系统弹出确认弹窗（“确认取消XX课程的预约？”）<br>4. 学员点击“确认”，系统调用`ReservationService.cancelReservation()`更新状态<br>5. 取消成功，页面提示“预约已取消”，余额同步更新 |
| 扩展流程 | 1. 距离上课时间<2小时：系统提示“距离上课时间不足2小时，无法取消预约”<br>2. 预约已取消/已完成：系统提示“该预约已失效，无需取消” |


### 5.4 处理教练取消预约申请（UC4_4）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC4_4 |
| 用例名称 | 处理教练取消预约申请 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 教练已发起针对学员预约课程的取消申请 |
| 后置条件 | 1. 学员确认后，预约记录状态更新为“教练取消”<br>2. 课时/金额退还至学员账户<br>3. 发送确认通知给教练 |
| 基本流程 | 1. 学员收到“教练取消预约”通知，点击进入详情页<br>2. 页面展示教练取消原因、课程信息，提供“确认”按钮<br>3. 学员点击“确认”，系统调用`ReservationService.confirmCoachCancel()`更新状态<br>4. 处理完成，页面提示“已确认教练取消预约，课时已退还” |
| 扩展流程 | 1. 学员未及时确认：系统在24小时后自动确认，同步更新状态 |


## 6. 评论课程模块

### 6.1 查看我的评价和收到的评价（UC5_1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC5_1 |
| 用例名称 | 查看我的评价和收到的评价 |
| 参与者 | 学员 |
| 前置条件 | 学员已登录系统 |
| 后置条件 | 系统分别展示“我发表的评价”和“教练对我的评价”列表 |
| 基本流程 | 1. 学员进入“评论课程-我的评价”页面<br>2. 页面分为两个标签页：<br>   - “我发表的评价”：调用`CommentService.getMyComments()`展示学员对课程/教练的评价<br>   - “收到的评价”：调用`CommentService.getReceivedComments()`展示教练对学员的评价<br>3. 每条评价展示“评价对象、评分、内容、时间、回复（若有）” |
| 扩展流程 | 1. 无评价记录：对应标签页提示“暂无评价记录” |


### 6.2 创建评价（UC5_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC5_2 |
| 用例名称 | 创建评价 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在“已完成”状态的课程，且未对该课程发表过评价 |
| 后置条件 | 1. 系统在`comment`表新增评价记录（关联学员ID、课程ID/教练ID）<br>2. 教练收到“新评价”通知 |
| 基本流程 | 1. 学员完成课程后，系统推送“评价课程”提醒，或学员进入“我的课程-已完成”页面<br>2. 点击“评价”按钮，进入评价编辑页<br>3. 选择评分（1-5星）、填写评价内容（≥10字），可上传课程照片（可选）<br>4. 点击“提交评价”，系统调用`CommentService.createComment()`保存数据<br>5. 提交成功，页面提示“评价发表成功” |
| 扩展流程 | 1. 已发表评价：系统提示“您已对该课程发表过评价，无法重复评价”<br>2. 评价内容<10字：系统提示“评价内容需至少10字” |


### 6.3 编辑我的评价（UC5_3）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC5_3 |
| 用例名称 | 编辑我的评价 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在“已发表”状态的评价，且距离发表时间≤7天 |
| 后置条件 | 评价记录（评分、内容、照片）更新至`comment`表 |
| 基本流程 | 1. 学员进入“评论课程-我的评价”页面<br>2. 找到目标评价，点击“编辑”按钮<br>3. 修改评分、内容或照片（规则同创建评价）<br>4. 点击“保存修改”，系统调用`CommentService.updateComment()`更新数据<br>5. 保存成功，页面刷新展示更新后评价 |
| 扩展流程 | 1. 距离发表时间>7天：系统提示“评价发表超过7天，无法编辑”<br>2. 评价已被回复：系统提示“该评价已收到教练回复，无法编辑” |


### 6.4 删除我的评价（UC5_4）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC5_4 |
| 用例名称 | 删除我的评价 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在“已发表”状态的评价 |
| 后置条件 | 评价记录状态更新为“已删除”（逻辑删除，保留数据） |
| 基本流程 | 1. 学员进入“评论课程-我的评价”页面<br>2. 找到目标评价，点击“删除”按钮<br>3. 系统弹出确认弹窗（“确认删除该评价？删除后不可恢复”）<br>4. 学员点击“确认”，系统调用`CommentService.deleteComment()`更新状态<br>5. 删除成功，页面提示“评价已删除”，列表中不再展示该评价 |
| 扩展流程 | 1. 评价已被回复：系统提示“该评价已收到教练回复，删除后回复也将隐藏，是否继续？”（学员确认后可删除） |


## 7. 乒乓月赛模块

### 7.1 报名参赛（UC6_1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC6_1 |
| 用例名称 | 报名参赛 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在所属校区的“报名中”状态的乒乓月赛<br>3. 学员未报名该比赛 |
| 后置条件 | 1. 系统在`competition_enrollment`表新增报名记录（学员ID-比赛ID）<br>2. 发送“报名成功”通知给学员 |
| 基本流程 | 1. 学员进入“乒乓月赛-赛事列表”页面<br>2. 找到所属校区的月赛，点击“报名参赛”按钮（若比赛需缴费，展示缴费金额）<br>3. 若需缴费：确认缴费金额，选择支付方式完成支付；若免费，直接进入确认页<br>4. 点击“确认报名”，系统调用`CompetitionService.enroll()`创建报名记录<br>5. 报名成功，页面提示“已成功报名XX比赛” |
| 扩展流程 | 1. 比赛已截止报名：系统提示“该比赛报名已截止，无法报名”<br>2. 已报名该比赛：系统提示“您已报名该比赛，无需重复报名”<br>3. 缴费失败：系统提示“缴费失败，请重新尝试报名” |


### 7.2 查看赛程（UC6_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC6_2 |
| 用例名称 | 查看赛程 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在已报名或已发布赛程的乒乓月赛 |
| 后置条件 | 系统展示目标比赛的完整赛程（含各阶段对阵、时间、场地、结果） |
| 基本流程 | 1. 学员进入“乒乓月赛-我的赛程”或“赛事详情”页面<br>2. 选择目标比赛，系统调用`CompetitionService.getSchedule()`获取赛程数据<br>3. 页面按“小组赛”“淘汰赛”“决赛”分阶段展示赛程，标注学员自身的对阵信息（若有）<br>4. 已结束的场次展示比赛结果，未开始的场次展示倒计时 |
| 扩展流程 | 1. 比赛未发布赛程：系统提示“该比赛尚未发布赛程，请稍后查看”<br>2. 未报名比赛：仅展示公开赛程，无个人对阵标注 |


## 8. 通知模块

### 8.1 更换教练通知（UC7_1）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC7_1 |
| 用例名称 | 更换教练通知 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 教练更换申请已审批通过 |
| 后置条件 | 学员查看通知详情，了解新教练信息及生效时间 |
| 基本流程 | 1. 系统在教练更换申请通过后，自动发送通知至学员“消息中心”<br>2. 学员点击通知进入详情页，查看“新教练姓名、联系方式、生效时间”<br>3. 页面提供“查看新教练详情”按钮，支持快速跳转至教练详情页 |
| 扩展流程 | - |


### 8.2 上课提醒（UC7_2）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC7_2 |
| 用例名称 | 上课提醒 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在“已预约”状态的课程，且距离上课时间=1小时 |
| 后置条件 | 学员查看提醒，确认上课时间、地点、教练信息 |
| 基本流程 | 1. 系统在上课前1小时自动发送提醒至学员“消息中心”（含APP推送）<br>2. 提醒内容包含“课程名称、上课时间、地点、教练、预约状态”<br>3. 学员点击提醒可跳转至“我的预约”页面，查看详情或取消预约（若符合条件） |
| 扩展流程 | - |


### 8.3 评课提醒（UC7_3）
| 项目 | 内容 |
|------|------|
| 用例编号 | UC7_3 |
| 用例名称 | 评课提醒 |
| 参与者 | 学员 |
| 前置条件 | 1. 学员已登录系统<br>2. 存在“已完成”状态的课程，且未发表评价，距离课程结束≤24小时 |
| 后置条件 | 学员查看提醒，跳转至评价页面发表评价 |
| 基本流程 | 1. 课程结束后，系统发送“评课提醒”至学员“消息中心”<br>2. 提醒内容包含“已完成课程名称、评价入口”<br>3. 学员点击“去评价”按钮，跳转至评价编辑页，完成评价发表 |
| 扩展流程 | 1. 学员已发表评价：系统不再发送提醒 |